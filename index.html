<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>jquery.wheretables.js</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>jquery.wheretables.js</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-Introduction'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Introduction">&#182;</a>
        </div>
        <h2>Introduction</h2>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-Prerequisites'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Prerequisites">&#182;</a>
        </div>
        <p><strong>whereTables</strong> is a <a href="http://www.jquery.com">jQuery</a> plugin that give you
the ability to toggle the visibility of certain columns in a table. This
plugin is <code>colspan</code> aware, but does not yet work with <code>rowspan</code>. This
library is over-engineered for the purpose of proposing an architecture to
the team in an effort to get feedback and establish some structure for
future javascript work.</p>

<p>This documentation was generated by running the
<a href="jquery.wheretables.js">source code</a> through the 
 <a href="https://github.com/rtomayko/rocco">Rocco</a> ruby gem.</p>

<h3>Prerequisites</h3>

<p>whereTables depends on the <a href="http://www.jquery.com">jQuery</a> library so it
must already be included on the page. Following that, you&rsquo;ll need to include
this library. You can do so with the following, adjusting the path as
necessary:</p>

<pre><code>&lt;script src=&ldquo;/path/tp/jquery.wheretables.js&rdquo;&gt;&lt;/script&gt;
</code></pre>

<h3>Initialization</h3>

<p>After including whereTables, initialize it by calling <code>.whereTables()</code>
on the elements you want it applied to (e.g., <code>$(&lsquo;table&rsquo;)</code> or
<code>$(&lsquo;table.toggleColumns&rsquo;)</code>).</p>

<h3>To-Do List</h3>

<ul>
<li>Add support for rowspan.</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>Immediately-executing anonymous function (closure!). <code>window</code> and
<code>undefined</code> are pulled into the local scope for performance and
data-integrity.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">$</span><span class="p">,</span> <span class="nb">window</span><span class="p">,</span> <span class="kc">undefined</span> <span class="p">){</span></pre></div>
      </td>
    </tr>
    <tr id='section-Class_Definition'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Class_Definition">&#182;</a>
        </div>
        <h2>Class Definition</h2>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <p>We start by creating a <code>whereTables</code> &ldquo;class&rdquo; that takes two parameters:
<code>target</code> which is the target element and <code>id</code> which is the numeric id of
this instance. <code>id</code> could be pulled out but I&rsquo;m leaving it as a function
parameter in case I add the ability to reuse removed ids.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="kd">var</span> <span class="nx">whereTables</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">id</span> <span class="p">){</span></pre></div>
      </td>
    </tr>
    <tr id='section-Private_Variables'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Private_Variables">&#182;</a>
        </div>
        <h3>Private Variables</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-7">&#182;</a>
        </div>
        <p><strong>Note</strong>: I like to prefix jquery objects with <code>$</code> but that is purely a
personal convention.</p>

<p>Set <code>self</code> to <code>this</code> to hold a reference to the current scope.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
      <span class="nx">$target</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="nx">target</span> <span class="p">),</span>
      <span class="nx">columnStates</span><span class="p">,</span>
      <span class="nx">columnVisibility</span> <span class="o">=</span> <span class="p">[];</span>
 </pre></div>
      </td>
    </tr>
    <tr id='section-Public_Variables'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Public_Variables">&#182;</a>
        </div>
        <h3>Public Variables</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-9'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-9">&#182;</a>
        </div>
        <p>The repeated declaration is just to provide a shorthand reference to
the variable (read-only for primitives). The current variables are:</p>

<ul>
<li><p><code>id</code>: An auto-incremented value for this instance.</p></li>
<li><p><code>columnCount</code>: The calculated number of columns (this is colspan
aware).</p></li>
<li><p><code>elements</code>: A hash that contains all the relevant elements or—in
other words—everything on the dom the javascript would want to
talk to. Sort of worthless here since we&rsquo;re not generating anything
new, and we&rsquo;re only holding onto the <code>target</code>.</p></li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">self</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">columnCount</span> <span class="o">=</span> <span class="nx">columnCount</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">elements</span> <span class="o">=</span> <span class="nx">elements</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">target</span><span class="o">:</span> <span class="nx">target</span>
    <span class="p">};</span></pre></div>
      </td>
    </tr>
    <tr id='section-Initialization'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Initialization">&#182;</a>
        </div>
        <h3>Initialization</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-11">&#182;</a>
        </div>
        <p><strong>Note</strong>: I would consider putting the following in an init method.</p>

<p>Count the number of columns intelligently and save their current
visibility in columnVisibility for quick lookups.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">columnCount</span> <span class="o">=</span> <span class="nx">countColumns</span><span class="p">(),</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">c</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
      <span class="nx">columnVisibility</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="kc">true</span> <span class="p">);</span>
    <span class="p">}</span></pre></div>
      </td>
    </tr>
    <tr id='section-12'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-12">&#182;</a>
        </div>
        <p>Add column number classes to the table cells.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">writeColumnPositions</span><span class="p">();</span></pre></div>
      </td>
    </tr>
    <tr id='section-Private_Methods'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Private_Methods">&#182;</a>
        </div>
        <h3>Private Methods</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-writeColumnPositions'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-writeColumnPositions">&#182;</a>
        </div>
        <h4>writeColumnPositions</h4>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-15'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-15">&#182;</a>
        </div>
        <p><code>writeColumnPositions</code> adds classes to table cells indicating their
which columns they are in. I cannot rely on selectors because of colspan
so I&rsquo;ve chosen to explicitly map this stuff out.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="kd">function</span> <span class="nx">writeColumnPositions</span><span class="p">(</span> <span class="p">){</span>
      
      <span class="kd">var</span> <span class="nx">colspanBias</span><span class="p">;</span></pre></div>
      </td>
    </tr>
    <tr id='section-16'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-16">&#182;</a>
        </div>
        <p>For each <code>tr</code> in the <code>target</code> element</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">$</span><span class="p">(</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">target</span> <span class="p">).</span><span class="nx">each</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">v</span> <span class="p">){</span></pre></div>
      </td>
    </tr>
    <tr id='section-17'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-17">&#182;</a>
        </div>
        <p>reset the <code>colspan</code> bias,</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nx">colspanBias</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></pre></div>
      </td>
    </tr>
    <tr id='section-18'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-18">&#182;</a>
        </div>
        <p>find each table cell (<code>th</code>, <code>td</code>),</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nx">$</span><span class="p">(</span> <span class="s1">&#39;th, td&#39;</span><span class="p">,</span> <span class="k">this</span> <span class="p">).</span><span class="nx">each</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">v</span> <span class="p">){</span>
          <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">),</span>
            <span class="nx">colspan</span> <span class="o">=</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span> <span class="s1">&#39;colspan&#39;</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-19'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-19">&#182;</a>
        </div>
        <p>and add a <code>class</code> for the current column.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>          <span class="nx">$this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="s1">&#39;WC-ypos-&#39;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">colspanBias</span> <span class="p">)</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-20'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-20">&#182;</a>
        </div>
        <p>If it has a <code>colspan</code> of more than <code>1</code>,</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>          <span class="k">if</span> <span class="p">(</span> <span class="nx">colspan</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">){</span></pre></div>
      </td>
    </tr>
    <tr id='section-21'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-21">&#182;</a>
        </div>
        <p>add each subsequent <code>class</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>            <span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">c</span> <span class="o">&lt;</span> <span class="nx">colspan</span><span class="p">;</span> <span class="nx">c</span><span class="o">++</span> <span class="p">){</span>
              <span class="nx">$this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="s1">&#39;WC-ypos-&#39;</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">colspanBias</span> <span class="o">+</span> <span class="nx">c</span> <span class="p">)</span> <span class="p">);</span>
            <span class="p">}</span></pre></div>
      </td>
    </tr>
    <tr id='section-22'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-22">&#182;</a>
        </div>
        <p>increase the <code>colspan</code> bias accordingly.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>            <span class="nx">colspanBias</span> <span class="o">+=</span> <span class="nx">colspan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="p">);</span>
      <span class="p">}</span> <span class="p">);</span>

    <span class="p">}</span></pre></div>
      </td>
    </tr>
    <tr id='section-toggleColumnVisibility'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-toggleColumnVisibility">&#182;</a>
        </div>
        <h4>toggleColumnVisibility</h4>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-24'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-24">&#182;</a>
        </div>
        <p><code>toggleColumnVisibility</code> shows or hides columns intelligently (taking
<code>colspan</code> into account). It takes two parameters:</p>

<ul>
<li><p><code>index</code>: the column number (zero index).</p></li>
<li><p><code>visible</code>: <em>optional</em>. If true, shows the column. If false, hides it.
If omitted, toggles the current state.</p></li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="kd">function</span> <span class="nx">toggleColumnVisibility</span><span class="p">(</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">visible</span> <span class="p">){</span></pre></div>
      </td>
    </tr>
    <tr id='section-25'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-25">&#182;</a>
        </div>
        <p>Find all the relevant table cells.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="kd">var</span>
        <span class="nx">$allElems</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;td.WC-ypos-&#39;</span> <span class="o">+</span> <span class="nx">index</span> <span class="o">+</span> <span class="s1">&#39;, th.WC-ypos-&#39;</span> <span class="o">+</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">target</span> <span class="p">),</span></pre></div>
      </td>
    </tr>
    <tr id='section-26'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-26">&#182;</a>
        </div>
        <p>isolate them by those with a colspan</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nx">$colspanElems</span> <span class="o">=</span> <span class="nx">$allElems</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="s1">&#39;[colspan]&#39;</span><span class="p">),</span></pre></div>
      </td>
    </tr>
    <tr id='section-27'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-27">&#182;</a>
        </div>
        <p>and those without.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nx">$singleElems</span> <span class="o">=</span> <span class="nx">$allElems</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="s1">&#39;[colspan]&#39;</span><span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-28'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-28">&#182;</a>
        </div>
        <p>if <code>visible</code> is omitted, toggle the current state and, regardless,
save the new visible state in the columnVisibility array.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">columnVisibility</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">visible</span> <span class="o">=</span> <span class="nx">visible</span> <span class="o">|</span> <span class="o">!</span> <span class="nx">columnVisibility</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span></pre></div>
      </td>
    </tr>
    <tr id='section-29'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-29">&#182;</a>
        </div>
        <p>Set non-<code>colspan</code> elements to the right visibility.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">$singleElems</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="nx">visible</span><span class="o">?</span><span class="s1">&#39;table-cell&#39;</span><span class="o">:</span><span class="s1">&#39;none&#39;</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-30'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-30">&#182;</a>
        </div>
        <p>for each <code>colspan</code> elements</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">$colspanElems</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">columnsVisible</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></pre></div>
      </td>
    </tr>
    <tr id='section-31'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-31">&#182;</a>
        </div>
        <p>find out which columns it takes up</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="kd">var</span> <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">){</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">))[</span><span class="mi">2</span><span class="p">];</span>
        <span class="p">}</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-32'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-32">&#182;</a>
        </div>
        <p>then check which of those columns is visible.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="nx">indexes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
          <span class="k">if</span> <span class="p">(</span> <span class="nx">columnVisibility</span><span class="p">[</span><span class="k">this</span><span class="p">]</span> <span class="p">)</span> <span class="nx">columnsVisible</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-33'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-33">&#182;</a>
        </div>
        <p>If none of them are visible, hide that table-cell.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="k">if</span> <span class="p">(</span> <span class="nx">columnsVisible</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">$this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span> <span class="s1">&#39;colspan&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">).</span><span class="nx">css</span><span class="p">(</span> <span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-34'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-34">&#182;</a>
        </div>
        <p>Otherwise, reduce the <code>colspan</code> and make sure it&rsquo;s visible.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">$this</span>
            <span class="p">.</span><span class="nx">attr</span><span class="p">(</span> <span class="s1">&#39;colspan&#39;</span><span class="p">,</span> <span class="nx">columnsVisible</span> <span class="p">)</span>
            <span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;table-cell&#39;</span> <span class="p">);</span>
        <span class="p">}</span>

      <span class="p">}</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
    <tr id='section-35'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-35">&#182;</a>
        </div>
        <p>Trigger an event to signify a column has been shown or hidden.
Either a <code>showColumn.whereTables</code> or <code>hideColumn.whereTables</code> event
will be emitted from the <code>target</code> element with one argument that holds
the <code>index</code> of the affected column.</p>

<p>This is useful for when you want to tie additional functionality to
when a column is shown or hidden, outside of this plugin. For example,
to make an alert pop up with the column <code>index</code> when a column is
shown, you could use something like the following:</p>

<pre><code>$(targetObject).bind(
    &lsquo;showColumn.whereTables&rsquo;,
    function( event, index ){
        alert( index );
    }
);
</code></pre>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">$target</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span> <span class="p">(</span><span class="nx">visible</span><span class="o">?</span><span class="s1">&#39;show&#39;</span><span class="o">:</span><span class="s1">&#39;hide&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;Column.whereTables&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="p">);</span>
    <span class="p">}</span></pre></div>
      </td>
    </tr>
    <tr id='section-countColumns'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-countColumns">&#182;</a>
        </div>
        <h4>countColumns</h4>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-37'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-37">&#182;</a>
        </div>
        <p><code>countColumns</code> intelligently counts the maximum number of columns by
taking <code>colspan</code> into account. Memoizes the value unless you pass in
the <em>optional</em> parameter <code>forceRefresh</code> with a value of <code>true</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="kd">function</span> <span class="nx">countColumns</span><span class="p">(</span> <span class="nx">forceRefresh</span> <span class="p">){</span></pre></div>
      </td>
    </tr>
    <tr id='section-38'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-38">&#182;</a>
        </div>
        <p>If we&rsquo;ve already calculated a value or we&rsquo;re <code>forceRefresh</code>, return
the previous value.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">forceRefresh</span> <span class="o">&amp;&amp;</span> <span class="nx">columnCount</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">columnCount</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">cols</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></pre></div>
      </td>
    </tr>
    <tr id='section-39'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-39">&#182;</a>
        </div>
        <p>for the first <code>tr</code> in <code>target</code></p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">$</span><span class="p">(</span> <span class="s1">&#39;tr:first&#39;</span><span class="p">,</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">target</span> <span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-40'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-40">&#182;</a>
        </div>
        <p>find all the table-cells</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="p">.</span><span class="nx">children</span><span class="p">(</span> <span class="s1">&#39;td, th&#39;</span> <span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-41'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-41">&#182;</a>
        </div>
        <p>and count them up (including <code>colspan</code>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">v</span><span class="p">){</span>
          <span class="nx">cols</span> <span class="o">+=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span> <span class="s1">&#39;colspan&#39;</span> <span class="p">)</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span> <span class="p">);</span>
      
      <span class="k">return</span> <span class="nx">cols</span><span class="p">;</span>

    <span class="p">}</span></pre></div>
      </td>
    </tr>
    <tr id='section-Public_Methods_(API)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Public_Methods_(API)">&#182;</a>
        </div>
        <h3>Public Methods (API)</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-43'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-43">&#182;</a>
        </div>
        <p>Everything within this section is callable from the <code>api</code> object (talked
about below). They&rsquo;re all pretty self explanatory.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="p">{</span></pre></div>
      </td>
    </tr>
    <tr id='section-44'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-44">&#182;</a>
        </div>
        <p>I stick debug methods in here.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">DEBUG</span><span class="o">:</span> <span class="p">{</span></pre></div>
      </td>
    </tr>
    <tr id='section-45'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-45">&#182;</a>
        </div>
        <p>Print out the (private) <code>columnVisibility</code> array.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nx">printColumnVisibility</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
          <span class="nx">WT</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">columnVisibility</span> <span class="p">);</span>
        <span class="p">}</span>
      <span class="p">},</span></pre></div>
      </td>
    </tr>
    <tr id='section-46'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-46">&#182;</a>
        </div>
        <p><code>hideColumn</code> takes an <code>index</code> as a parameter, and hides that column.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">hideColumn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">index</span> <span class="p">){</span>
        <span class="nx">toggleColumnVisibility</span><span class="p">(</span> <span class="nx">index</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>
      <span class="p">},</span></pre></div>
      </td>
    </tr>
    <tr id='section-47'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-47">&#182;</a>
        </div>
        <p><code>toggleColumn</code> takes an <code>index</code> as a parameter, and toggles that
column.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">toggleColumn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">index</span> <span class="p">){</span>
        <span class="nx">toggleColumnVisibility</span><span class="p">(</span> <span class="nx">index</span> <span class="p">);</span>
      <span class="p">},</span></pre></div>
      </td>
    </tr>
    <tr id='section-48'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-48">&#182;</a>
        </div>
        <p><code>showColumn</code> takes an <code>index</code> as a parameter, and shows that column.</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>      <span class="nx">showColumn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">index</span> <span class="p">){</span>
        <span class="nx">toggleColumnVisibility</span><span class="p">(</span> <span class="nx">index</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
      <span class="p">}</span>

    <span class="p">}</span> <span class="p">);</span>

  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">WT</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">whereTables</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">request</span> <span class="p">){</span>

    <span class="k">if</span> <span class="p">(</span> <span class="s2">&quot;string&quot;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">request</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;&quot;</span> <span class="o">!==</span> <span class="nx">request</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">request</span> <span class="o">===</span> <span class="s1">&#39;api&#39;</span> <span class="p">)</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;whereTables&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;whereTables&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nx">api</span> <span class="o">&amp;&amp;</span> <span class="nx">api</span><span class="p">[</span><span class="nx">request</span><span class="p">]</span> <span class="p">){</span>
          <span class="nx">api</span><span class="p">[</span><span class="nx">request</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span> <span class="nx">api</span><span class="p">[</span><span class="nx">request</span><span class="p">],</span> <span class="nx">args</span> <span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">api</span> <span class="p">)</span>
            <span class="nx">WT</span><span class="p">.</span><span class="nx">log</span> <span class="p">(</span> <span class="s1">&#39;whereTables not initialized on %o&#39;</span><span class="p">,</span> <span class="k">this</span> <span class="p">);</span>
          <span class="k">else</span>
            <span class="nx">WT</span><span class="p">.</span><span class="nx">log</span> <span class="p">(</span> <span class="s1">&#39;Cannot find API method: %s&#39;</span><span class="p">,</span> <span class="nx">request</span> <span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="kd">function</span><span class="p">(){</span>

      <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">WT</span><span class="p">.</span><span class="nx">nextid</span><span class="o">++</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">whereTables</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">id</span> <span class="p">);</span>
      <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span> <span class="s1">&#39;whereTables&#39;</span><span class="p">,</span> <span class="nx">obj</span> <span class="p">);</span>

    <span class="p">}</span> <span class="p">);</span>

  <span class="p">};</span>

  <span class="nx">WT</span><span class="p">.</span><span class="nx">nextid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="nx">WT</span><span class="p">.</span><span class="nx">log</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span> <span class="o">&amp;&amp;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="p">)</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span> <span class="nx">console</span><span class="p">,</span> <span class="nx">arguments</span> <span class="p">);</span>
  <span class="p">};</span>

<span class="p">}</span> <span class="p">)</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span> <span class="p">);</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
